var ie=Object.defineProperty;var ae=(l,e,s)=>e in l?ie(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var I=(l,e,s)=>(ae(l,typeof e!="symbol"?e+"":e,s),s);import{s as j,n as D,o as z,A as le,h as ne,k as ee,B as re,r as oe}from"../chunks/scheduler.DqiQiJ2X.js";import{S as q,i as O,e as y,c as b,p as P,b as v,g as V,d as _,s as A,v as ce,h as te,a as B,l as E,w as he,f as w,y as S,x as de,D as ue,k as H,m as Z,u as m,n as Q,t as G,j as J,o as K}from"../chunks/index.CR_WoLMa.js";const fe=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ge(l){let e,s="This page requires Javascript to render. Sorry.";return{c(){e=y("canvas"),e.textContent=s,this.h()},l(r){e=b(r,"CANVAS",{id:!0,class:!0,"data-svelte-h":!0}),P(e)!=="svelte-h7z6jf"&&(e.textContent=s),this.h()},h(){v(e,"id","cell-canvas"),v(e,"class","svelte-mthozf")},m(r,c){V(r,e,c)},p:D,i:D,o:D,d(r){r&&_(e)}}}function pe(l,e,s){let{width:r=100}=e,{height:c=100}=e,{logic:f=(n,o,u,i,d)=>{let t={state:n.state};if(n.state>0)return t.state=n.state-1,t;for(let a of[-1,1])if(i(o+a,u).state==d)return t.state=d,t;for(let a of[-1,1])if(i(o,u+a).state==d)return t.state=d,t;return Math.trunc(Math.random()*1e4)==69&&(t.state=d),t}}=e,h;return z(()=>{class n{constructor(t,a,g=100,x=100){I(this,"palette");I(this,"cells");I(this,"canvas");I(this,"ctx");I(this,"width");I(this,"height");I(this,"cellLogic",()=>{});this.palette=[],this.setPalette(t),this.canvas=a,this.ctx=this.canvas.getContext("2d"),this.cells=Array.from({length:g*x},(F,k)=>{let L={state:Math.random()>.99?this.palette.length-1:0};return L.static&&(L.state=0),L}),this.height=x,this.width=g,this.canvas.width=this.width,this.canvas.height=this.height}setPalette(t){this.palette=[];for(let a of t){let g={r:parseInt(a.substring(1,3),16),g:parseInt(a.substring(3,5),16),b:parseInt(a.substring(5,7),16),a:255};this.palette.push(g)}}getCellWrapping(t,a){if(this.cells)return a%=this.height,t%=this.width,a<0&&(a=this.height+a),t<0&&(t=this.width+t),this.cells[this.width*a+t]}step(){this.cells=this.cells.map((t,a,g)=>{if(t.static)return t;let x=a%this.width,F=(a-x)/this.width;return this.cellLogic.bind(this)(t,x,F,this.getCellWrapping.bind(this),this.palette.length-1)||t})}setCellLogic(t){this.cellLogic=t}render(){let t=new Uint8ClampedArray(4*this.width*this.height);this.cells.map((a,g)=>this.palette[a.state]).forEach((a,g)=>{t[g*4]=a.r,t[g*4+1]=a.g,t[g*4+2]=a.b,t[g*4+3]=a.a}),this.ctx.putImageData(new ImageData(t,this.width,this.height),0,0)}}const o=[["#030516","#2A4347","#218278","#18C0A9","#0FFFDB"],["#05252A","#431F32","#821A3A","#c01442","#FF0F4B"],["#4F1A4D","#432360","#372C73","#2B3686","#1F3F99","#1449AC"],["#000009","#4B00FF","#09DFFF","#4BFF09","#DFFB00","#FFB409","#FF0F4B"]];let u=parseInt(new URL(window.location.href).searchParams.get("palette"))%o.length||0,i=new n(o[u],document.getElementById("cell-canvas"),r,c);i.setCellLogic(f),document.getElementById("cell-canvas").onclick=()=>{u+=1,u%=o.length,i.setPalette(o[u])},h=setInterval(()=>{i.step(),i.render()},1e3/30)}),le(()=>{h&&clearInterval(h)}),l.$$set=n=>{"width"in n&&s(0,r=n.width),"height"in n&&s(1,c=n.height),"logic"in n&&s(2,f=n.logic)},[r,c,f]}class me extends q{constructor(e){super(),O(this,e,pe,ge,j,{width:0,height:1,logic:2})}}const{document:$}=fe;function ve(l){let e,s="",r,c,f,h,n,o,u;return{c(){e=y("script"),e.innerHTML=s,c=A(),f=y("div"),h=y("div"),n=ce(l[0]),this.h()},l(i){const d=te("svelte-7fphnf",$.head);e=b(d,"SCRIPT",{src:!0,integrity:!0,crossorigin:!0,referrerpolicy:!0,"data-svelte-h":!0}),P(e)!=="svelte-1but1ta"&&(e.innerHTML=s),d.forEach(_),c=B(i),f=b(i,"DIV",{id:!0,class:!0});var t=E(f);h=b(t,"DIV",{id:!0,class:!0});var a=E(h);n=he(a,l[0]),a.forEach(_),t.forEach(_),this.h()},h(){ne(e.src,r="https://cdnjs.cloudflare.com/ajax/libs/ace/1.33.0/ace.min.js")||v(e,"src",r),v(e,"integrity","sha512-RFjWk8prkK/avV0PuBatirOL57/Q/WSh6BZ82tohL95Ug5h+S9sZoVpRtk+L8LI6q0q5z5wCyrb9N2X+IuNcfA=="),v(e,"crossorigin","anonymous"),v(e,"referrerpolicy","no-referrer"),v(h,"id","editor"),v(h,"class","svelte-bz8xh7"),v(f,"id","editor-container"),v(f,"class","svelte-bz8xh7")},m(i,d){w($.head,e),l[4](e),V(i,c,d),V(i,f,d),w(f,h),w(h,n),o||(u=S(e,"load",l[2]),o=!0)},p(i,[d]){d&1&&de(n,i[0])},i:D,o:D,d(i){i&&(_(c),_(f)),_(e),l[4](null),o=!1,u()}}}function _e(l,e,s){let{value:r=""}=e,{editor:c=void 0}=e,f;function h(){console.log("script loaded");var o=ace.edit("editor");o.setTheme("ace/theme/gruvbox"),o.session.setMode("ace/mode/javascript");let u=new URL(window.location.href).searchParams.get("script");u&&o.setValue(atob(u)||r),s(3,c=o),document.getElementById("editor").style.display="block"}z(()=>{c||h()});function n(o){ee[o?"unshift":"push"](()=>{f=o,s(1,f)})}return l.$$set=o=>{"value"in o&&s(0,r=o.value),"editor"in o&&s(3,c=o.editor)},[r,f,h,c,n]}class we extends q{constructor(e){super(),O(this,e,_e,ve,j,{value:0,editor:3})}}function ye(l){let e,s,r,c='<h2 style="border-bottom: 2px dotted white;">&gt;./CELLULAR_AUTOMATA</h2> <p>I made this after watching a <a href="https://www.youtube.com/watch?v=SqhXQUzVMlQ" target="_blank" class="svelte-1y32402">Steve Mould video</a> on <i class="svelte-1y32402">Excitable Media</i>, which I then learned could be represented with <a href="https://en.wikipedia.org/wiki/Cellular_automaton" target="_blank" class="svelte-1y32402">cellular automata</a>. I thought the idea was cool, and it reminded me of <a href="https://en.wikipedia.org/wiki/Belousov%E2%80%93Zhabotinsky_reaction" target="_blank" class="svelte-1y32402">the Belousov-Zhabotinsky reaction</a>, so I wanted to make one. Turns out, onces you have one cellular automata set up, it&#39;s pretty easy to just, make another. Or generalize it. I did that.</p> <br/> <p>WIP. Will include:</p> <ul><li>A few automata presets</li> <li>Customizable palettes</li> <li>Proper documentation</li></ul> <p>(Click the cells to change the palette, btw.)</p>',f,h,n,o,u,i,d,t,a,g,x="Compile",F,k,L="Copy link",U,R,X;function se(p){l[4](p)}let W={value:`/*
  This JS code is run once per cell (100x100 = 10000 calls per frame. Be mindful.).
  variables:
    x: X position of the cell
    y: Y position of the cell
    cell: The original cell. It is advised you make a new cell as seen below.
    getCell(x, y): Gets a cell based on the coordinates.
    max_value: The highest state a cell can be in (based on the palette)

  Review the below code to get some ideas.
*/

let new_cell = {
  state: cell.state
};

if(cell.state > 0) {
  new_cell.state = cell.state - 1;
  return new_cell;
}

for(let offsetX of [-1, 1]) {
  if(getCell(x + offsetX, y).state == max_value) {
    new_cell.state = max_value;
    return new_cell;
  }
}

for(let offsetY of [-1, 1]) {
  if(getCell(x, y + offsetY).state == max_value) {
    new_cell.state = max_value; 
    return new_cell;
  }
}

if(Math.trunc(Math.random() * 10000) == 69) {
  new_cell.state = max_value;
}

return new_cell;`};return l[0]!==void 0&&(W.editor=l[0]),n=new we({props:W}),ee.push(()=>ue(n,"editor",se)),t=new me({props:{logic:l[1]}}),{c(){e=A(),s=y("div"),r=y("div"),r.innerHTML=c,f=A(),h=y("div"),H(n.$$.fragment),u=A(),i=y("div"),d=y("div"),H(t.$$.fragment),a=A(),g=y("button"),g.textContent=x,F=A(),k=y("button"),k.textContent=L,this.h()},l(p){te("svelte-1djkzu0",document.head).forEach(_),e=B(p),s=b(p,"DIV",{style:!0});var C=E(s);r=b(C,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),P(r)!=="svelte-tyqlys"&&(r.innerHTML=c),f=B(C),h=b(C,"DIV",{class:!0,style:!0});var N=E(h);Z(n.$$.fragment,N),N.forEach(_),u=B(C),i=b(C,"DIV",{class:!0,style:!0});var T=E(i);d=b(T,"DIV",{class:!0,style:!0});var Y=E(d);Z(t.$$.fragment,Y),Y.forEach(_),a=B(T),g=b(T,"BUTTON",{"data-svelte-h":!0}),P(g)!=="svelte-1dql93c"&&(g.textContent=x),F=B(T),k=b(T,"BUTTON",{"data-svelte-h":!0}),P(k)!=="svelte-32d48k"&&(k.textContent=L),T.forEach(_),C.forEach(_),this.h()},h(){document.title="CELLULAR_AUTOMATA",v(r,"class","terminal-container svelte-1y32402"),m(r,"flex","1"),v(h,"class","terminal-container svelte-1y32402"),m(h,"flex","2"),m(h,"height","100%"),m(h,"padding","0"),m(h,"overflow","hidden"),v(d,"class","grid svelte-1y32402"),m(d,"width","100%"),v(i,"class","terminal-container svelte-1y32402"),m(i,"flex","1"),m(i,"height","100%"),m(i,"padding","18px"),m(i,"padding-top","30px"),m(s,"display","flex"),m(s,"flex-direction","row"),m(s,"height","100%"),m(s,"margin-top","5px")},m(p,M){V(p,e,M),V(p,s,M),w(s,r),w(s,f),w(s,h),Q(n,h,null),w(s,u),w(s,i),w(i,d),Q(t,d,null),w(i,a),w(i,g),w(i,F),w(i,k),U=!0,R||(X=[S(d,"mousemove",be),S(g,"click",l[2]),S(k,"click",l[3])],R=!0)},p(p,[M]){const C={};!o&&M&1&&(o=!0,C.editor=p[0],re(()=>o=!1)),n.$set(C)},i(p){U||(G(n.$$.fragment,p),G(t.$$.fragment,p),U=!0)},o(p){J(n.$$.fragment,p),J(t.$$.fragment,p),U=!1},d(p){p&&(_(e),_(s)),K(n),K(t),R=!1,oe(X)}}}function be(l){const{currentTarget:e}=l,s=e.getBoundingClientRect(),r=l.clientX-s.left,c=l.clientY-s.top;e.style.setProperty("--mouse-x",`${r}px`),e.style.setProperty("--mouse-y",`${c}px`)}function Ce(l,e,s){let r=new Function,c,f=(u,i,d,t,a)=>r(u,i,d,t,a);function h(){c&&(r=new Function("cell","x","y","getCell","max_value",c.getValue()))}function n(){if(c){let u=new URL(window.location.href);u.searchParams.set("script",btoa(c.getValue())),navigator.clipboard.writeText(u.href)}}z(()=>{h()});function o(u){c=u,s(0,c)}return[c,f,h,n,o]}class Fe extends q{constructor(e){super(),O(this,e,Ce,ye,j,{})}}export{Fe as component};
