var ee=Object.defineProperty;var te=(r,e,s)=>e in r?ee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var I=(r,e,s)=>(te(r,typeof e!="symbol"?e+"":e,s),s);import{s as j,n as E,o as U,A as se,h as ie,k as J,B as ae,r as le}from"../chunks/scheduler.DqiQiJ2X.js";import{S as q,i as R,e as y,c as b,p as V,b as v,g as M,d as _,s as T,v as ne,h as K,a as B,l as A,w as re,f as w,y as S,x as oe,D as ce,k as W,m as Y,u as m,n as H,t as N,j as Z,o as Q}from"../chunks/index.CR_WoLMa.js";const de=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function he(r){let e,s="This page requires Javascript to render. Sorry.";return{c(){e=y("canvas"),e.textContent=s,this.h()},l(o){e=b(o,"CANVAS",{id:!0,class:!0,"data-svelte-h":!0}),V(e)!=="svelte-h7z6jf"&&(e.textContent=s),this.h()},h(){v(e,"id","cell-canvas"),v(e,"class","svelte-mthozf")},m(o,d){M(o,e,d)},p:E,i:E,o:E,d(o){o&&_(e)}}}function ue(r,e,s){let{width:o=100}=e,{height:d=100}=e,{logic:u=(l,n,p,i,h)=>{let t={state:l.state};if(l.state>0)return t.state=l.state-1,t;for(let a of[-1,1])if(i(n+a,p).state==h)return t.state=h,t;for(let a of[-1,1])if(i(n,p+a).state==h)return t.state=h,t;return Math.trunc(Math.random()*1e4)==69&&(t.state=h),t}}=e,c;return U(()=>{class l{constructor(t,a,f=100,x=100){I(this,"palette");I(this,"cells");I(this,"canvas");I(this,"ctx");I(this,"width");I(this,"height");I(this,"cellLogic",()=>{});this.palette=[],this.setPalette(t),this.canvas=a,this.ctx=this.canvas.getContext("2d"),this.cells=Array.from({length:f*x},(F,D)=>{let k={state:Math.random()>.99?this.palette.length-1:0};return k.static&&(k.state=0),k}),this.height=x,this.width=f,this.canvas.width=this.width,this.canvas.height=this.height}setPalette(t){this.palette=[];for(let a of t){let f={r:parseInt(a.substring(1,3),16),g:parseInt(a.substring(3,5),16),b:parseInt(a.substring(5,7),16),a:255};this.palette.push(f)}}getCellWrapping(t,a){if(this.cells)return a%=this.height,t%=this.width,a<0&&(a=this.height+a),t<0&&(t=this.width+t),this.cells[this.width*a+t]}step(){this.cells=this.cells.map((t,a,f)=>{if(t.static)return t;let x=a%this.width,F=(a-x)/this.width;return this.cellLogic.bind(this)(t,x,F,this.getCellWrapping.bind(this),this.palette.length-1)||t})}setCellLogic(t){this.cellLogic=t}render(){let t=new Uint8ClampedArray(4*this.width*this.height);this.cells.map((a,f)=>this.palette[a.state]).forEach((a,f)=>{t[f*4]=a.r,t[f*4+1]=a.g,t[f*4+2]=a.b,t[f*4+3]=a.a}),this.ctx.putImageData(new ImageData(t,this.width,this.height),0,0)}}const n=[["#030516","#2A4347","#218278","#18C0A9","#0FFFDB"],["#05252A","#431F32","#821A3A","#c01442","#FF0F4B"],["#4F1A4D","#432360","#372C73","#2B3686","#1F3F99","#1449AC"],["#000009","#4B00FF","#09DFFF","#4BFF09","#DFFB00","#FFB409","#FF0F4B"]];let p=parseInt(new URL(window.location.href).searchParams.get("palette"))%n.length||0,i=new l(n[p],document.getElementById("cell-canvas"),o,d);i.setCellLogic(u),document.getElementById("cell-canvas").onclick=()=>{p+=1,p%=n.length,i.setPalette(n[p])},c=setInterval(()=>{i.step(),i.render()},1e3/30)}),se(()=>{c&&clearInterval(c)}),r.$$set=l=>{"width"in l&&s(0,o=l.width),"height"in l&&s(1,d=l.height),"logic"in l&&s(2,u=l.logic)},[o,d,u]}class fe extends q{constructor(e){super(),R(this,e,ue,he,j,{width:0,height:1,logic:2})}}const{document:G}=de;function ge(r){let e,s="",o,d,u,c,l,n,p;return{c(){e=y("script"),e.innerHTML=s,d=T(),u=y("div"),c=y("div"),l=ne(r[0]),this.h()},l(i){const h=K("svelte-7fphnf",G.head);e=b(h,"SCRIPT",{src:!0,integrity:!0,crossorigin:!0,referrerpolicy:!0,"data-svelte-h":!0}),V(e)!=="svelte-1but1ta"&&(e.innerHTML=s),h.forEach(_),d=B(i),u=b(i,"DIV",{id:!0,class:!0});var t=A(u);c=b(t,"DIV",{id:!0,class:!0});var a=A(c);l=re(a,r[0]),a.forEach(_),t.forEach(_),this.h()},h(){ie(e.src,o="https://cdnjs.cloudflare.com/ajax/libs/ace/1.33.0/ace.min.js")||v(e,"src",o),v(e,"integrity","sha512-RFjWk8prkK/avV0PuBatirOL57/Q/WSh6BZ82tohL95Ug5h+S9sZoVpRtk+L8LI6q0q5z5wCyrb9N2X+IuNcfA=="),v(e,"crossorigin","anonymous"),v(e,"referrerpolicy","no-referrer"),v(c,"id","editor"),v(c,"class","svelte-wt2ffw"),v(u,"id","editor-container"),v(u,"class","svelte-wt2ffw")},m(i,h){w(G.head,e),r[4](e),M(i,d,h),M(i,u,h),w(u,c),w(c,l),n||(p=S(e,"load",r[2]),n=!0)},p(i,[h]){h&1&&oe(l,i[0])},i:E,o:E,d(i){i&&(_(d),_(u)),_(e),r[4](null),n=!1,p()}}}function pe(r,e,s){let{value:o=""}=e,{editor:d=void 0}=e,u;function c(){console.log("script loaded");var n=ace.edit("editor");n.setTheme("ace/theme/gruvbox"),n.session.setMode("ace/mode/javascript"),s(3,d=n),document.getElementById("editor").style.display="block"}U(()=>{d||c()});function l(n){J[n?"unshift":"push"](()=>{u=n,s(1,u)})}return r.$$set=n=>{"value"in n&&s(0,o=n.value),"editor"in n&&s(3,d=n.editor)},[o,u,c,d,l]}class me extends q{constructor(e){super(),R(this,e,pe,ge,j,{value:0,editor:3})}}function ve(r){let e,s,o,d='<h2 style="border-bottom: 2px dotted white;">&gt;./CELLULAR_AUTOMATA</h2> <p>I made this after watching a <a href="https://www.youtube.com/watch?v=SqhXQUzVMlQ" target="_blank" class="svelte-1y32402">Steve Mould video</a> on <i class="svelte-1y32402">Excitable Media</i>, which I then learned could be represented with <a href="https://en.wikipedia.org/wiki/Cellular_automaton" target="_blank" class="svelte-1y32402">cellular automata</a>. I thought the idea was cool, and it reminded me of <a href="https://en.wikipedia.org/wiki/Belousov%E2%80%93Zhabotinsky_reaction" target="_blank" class="svelte-1y32402">the Belousov-Zhabotinsky reaction</a>, so I wanted to make one. Turns out, onces you have one cellular automata set up, it&#39;s pretty easy to just, make another. Or generalize it. I did that.</p> <br/> <p>WIP. Will include:</p> <ul><li>A few automata presets</li> <li>Customizable palettes</li> <li>Proper documentation</li></ul> <p>(Click the cells to change the palette, btw.)</p>',u,c,l,n,p,i,h,t,a,f,x="Compile",F,D,k;function $(g){r[3](g)}let X={value:`/*
  This JS code is run once per cell (100x100 = 10000 calls per frame. Be mindful.).
  variables:
    X: X position of the cell
    Y: Y position of the cell
    cell: The original cell. It is advised you make a new cell as seen below.
    getCell(x, y): Gets a cell based on the coordinates.

  Review the below code to get some ideas.
*/

let new_cell = {
  state: cell.state
};

if(cell.state > 0) {
  new_cell.state = cell.state - 1;
  return new_cell;
}

for(let offsetX of [-1, 1]) {
  if(getCell(x + offsetX, y).state == max_value) {
    new_cell.state = max_value;
    return new_cell;
  }
}

for(let offsetY of [-1, 1]) {
  if(getCell(x, y + offsetY).state == max_value) {
    new_cell.state = max_value; 
    return new_cell;
  }
}

if(Math.trunc(Math.random() * 10000) == 69) {
  new_cell.state = max_value;
}

return new_cell;`};return r[0]!==void 0&&(X.editor=r[0]),l=new me({props:X}),J.push(()=>ce(l,"editor",$)),t=new fe({props:{logic:r[1]}}),{c(){e=T(),s=y("div"),o=y("div"),o.innerHTML=d,u=T(),c=y("div"),W(l.$$.fragment),p=T(),i=y("div"),h=y("div"),W(t.$$.fragment),a=T(),f=y("button"),f.textContent=x,this.h()},l(g){K("svelte-1djkzu0",document.head).forEach(_),e=B(g),s=b(g,"DIV",{style:!0});var C=A(s);o=b(C,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),V(o)!=="svelte-tyqlys"&&(o.innerHTML=d),u=B(C),c=b(C,"DIV",{class:!0,style:!0});var z=A(c);Y(l.$$.fragment,z),z.forEach(_),p=B(C),i=b(C,"DIV",{class:!0,style:!0});var P=A(i);h=b(P,"DIV",{class:!0,style:!0});var O=A(h);Y(t.$$.fragment,O),O.forEach(_),a=B(P),f=b(P,"BUTTON",{"data-svelte-h":!0}),V(f)!=="svelte-1dql93c"&&(f.textContent=x),P.forEach(_),C.forEach(_),this.h()},h(){document.title="CELLULAR_AUTOMATA",v(o,"class","terminal-container svelte-1y32402"),m(o,"flex","1"),v(c,"class","terminal-container svelte-1y32402"),m(c,"flex","2"),m(c,"height","100%"),m(c,"padding","0"),m(c,"overflow","hidden"),v(h,"class","grid svelte-1y32402"),m(h,"width","100%"),v(i,"class","terminal-container svelte-1y32402"),m(i,"flex","1"),m(i,"height","100%"),m(i,"padding","18px"),m(i,"padding-top","30px"),m(s,"display","flex"),m(s,"flex-direction","row"),m(s,"height","100%"),m(s,"margin-top","5px")},m(g,L){M(g,e,L),M(g,s,L),w(s,o),w(s,u),w(s,c),H(l,c,null),w(s,p),w(s,i),w(i,h),H(t,h,null),w(i,a),w(i,f),F=!0,D||(k=[S(h,"mousemove",_e),S(f,"click",r[2])],D=!0)},p(g,[L]){const C={};!n&&L&1&&(n=!0,C.editor=g[0],ae(()=>n=!1)),l.$set(C)},i(g){F||(N(l.$$.fragment,g),N(t.$$.fragment,g),F=!0)},o(g){Z(l.$$.fragment,g),Z(t.$$.fragment,g),F=!1},d(g){g&&(_(e),_(s)),Q(l),Q(t),D=!1,le(k)}}}function _e(r){const{currentTarget:e}=r,s=e.getBoundingClientRect(),o=r.clientX-s.left,d=r.clientY-s.top;e.style.setProperty("--mouse-x",`${o}px`),e.style.setProperty("--mouse-y",`${d}px`)}function we(r,e,s){let o=new Function,d,u=(n,p,i,h,t)=>o(n,p,i,h,t);function c(){d&&(o=new Function("cell","x","y","getCell","max_value",d.getValue()))}U(()=>{c()});function l(n){d=n,s(0,d)}return[d,u,c,l]}class xe extends q{constructor(e){super(),R(this,e,we,ve,j,{})}}export{xe as component};
